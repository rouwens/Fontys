- name: Install filebeat
  hosts: web
  remote_user: root

- tasks:
  - name: Download Filebeat RPM
    get_url:
      url: https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.14.1-x86_64.rpm
      dest: /home/localadmin/filebeat.rpm

  - name: Install Filebeat
    ansible.builtin.shell: echo 'daan0409' | sudo -S rpm -i filebeat.rpm

  - name: Download Filebeat config
  - template:
      src: filebeat.yml
      dest: /etc/filebeat/filebeat.yml
  
  - name: Filebeat setup
    ansible.builtin.shell: echo 'daan0409' | sudo -S filebeat modules enable system 
  
  - name: Enable Filebeat service
    ansible.builtin.shell: echo 'daan0409' | sudo -S systemctl enable filebeat
  
  - name: Start Filebeat service
    ansible.builtin.shell: echo 'daan0409' | sudo -S systemctl start filebeat
  
  